Linux Searches and hunts

| Event Type | Category             | Search Name                                                                                                                           |
|------------|----------------------|---------------------------------------------------------------------------------------------------------------------------------------|
| Auditd     | Behavioral Detection |  abnormal end to file or directory access                                                                                             |
| Auditd     | Execution            |  file made executable                                                                                                                 |
| Auditd     | Behavioral Detection | !ELF activity                                                                                                                         |
| Auditd     | Behavioral Detection | amap - https://sectools.org/tool/amap/                                                                                                |
| Auditd     | Behavioral Detection | anomalous apt / yum connect                                                                                                           |
| Auditd     | Behavioral Detection | Anomalous memcache activity                                                                                                           |
| Auditd     | Behavioral Detection | Anomalous NFS Activity                                                                                                                |
| Auditd     | Behavioral Detection | anomalous package install                                                                                                             |
| Auditd     | Behavioral Detection | anomalous snapd activity                                                                                                              |
| Auditd     | Behavioral Detection | aprping http://www.habets.pp.se/synscan/programs.php?prog=arping                                                                      |
| Auditd     | Behavioral Detection | arpdig                                                                                                                                |
| Auditd     | Behavioral Detection | arp-sk                                                                                                                                |
| Auditd     | Behavioral Detection | arpwatch                                                                                                                              |
| Auditd     | Behavioral Detection | ASP auditor asp-audit.pl                                                                                                              |
| Auditd     | Behavioral Detection | base64 command                                                                                                                        |
| Auditd     | Behavioral Detection | base64 python - base64 AND python                                                                                                     |
| Auditd     | Execution            | bash started by nagios                                                                                                                |
| Auditd     | Behavioral Detection | cheops                                                                                                                                |
| Auditd     | Behavioral Detection | compiler - apt-get install build-essential                                                                                            |
| Auditd     | Behavioral Detection | compiler - gcc, make, yasm                                                                                                            |
| Auditd     | Behavioral Detection | covert_tcp                                                                                                                            |
| Auditd     | Behavioral Detection | cowpatty                                                                                                                              |
| Auditd     | Behavioral Detection | cp command on /passwd file                                                                                                            |
| Auditd     | Behavioral Detection | cp command on authorized_keys directory                                                                                               |
| Auditd     | Behavioral Detection | Curl, wget, lynx                                                                                                                      |
| Auditd     | Behavioral Detection | curses                                                                                                                                |
| Auditd     | Behavioral Detection | curses toolkit                                                                                                                        |
| Auditd     | Behavioral Detection | dirty sock                                                                                                                            |
| Auditd     | Behavioral Detection | dpkg or rpm installs                                                                                                                  |
| Auditd     | Behavioral Detection | dsniff                                                                                                                                |
| Auditd     | Privilege Escalation | echo "* ALL=(ALL) NOPASSWD: ALL" > /etc/sudoers                                                                                       |
| Auditd     | Behavioral Detection | echo 0 | sudo tee /proc/sys/net/ipv4/ip_unprivileged_port_start                                                                       |
| Auditd     | Behavioral Detection | echo AND  * base64 *                                                                                                                  |
| Auditd     | Behavioral Detection | echo to the sudoers file                                                                                                              |
| Auditd     | Behavioral Detection | etrace                                                                                                                                |
| Auditd     | Behavioral Detection | ettercap                                                                                                                              |
| Auditd     | Behavioral Detection | evinemtry memory dump                                                                                                                 |
| Auditd     | Behavioral Detection | file editor invoked by a user                                                                                                         |
| Auditd     | Behavioral Detection | file2air                                                                                                                              |
| Auditd     | Execution            | Fileless ELF execution                                                                                                                |
| Auditd     | Behavioral Detection | firewalk                                                                                                                              |
| Auditd     | Behavioral Detection | fl0p                                                                                                                                  |
| Auditd     | Behavioral Detection | fpdns                                                                                                                                 |
| Auditd     | Behavioral Detection | fragroute                                                                                                                             |
| Auditd     | Behavioral Detection | FreeRADIUS-WPE                                                                                                                        |
| Auditd     | Behavioral Detection | ftp activity by wget                                                                                                                  |
| Auditd     | Behavioral Detection | gnetcat                                                                                                                               |
| Auditd     | Behavioral Detection | http to remote not apt / yum                                                                                                          |
| Auditd     | Behavioral Detection | httprint                                                                                                                              |
| Auditd     | Behavioral Detection | httptunnel - hts / htc                                                                                                                |
| Auditd     | Behavioral Detection | hydra                                                                                                                                 |
| Auditd     | Behavioral Detection | icmp shell (ish)                                                                                                                      |
| Auditd     | Behavioral Detection | icmp-mtu (https://www.gont.com.ar/tools/icmp-attacks/index.html)                                                                      |
| Auditd     | Behavioral Detection | icmp-quench (https://www.gont.com.ar/tools/icmp-attacks/index.html)                                                                   |
| Auditd     | Behavioral Detection | icmpshell.sourceforge.net                                                                                                             |
| Auditd     | Behavioral Detection | iodine  - dns tunneling - iodine / iodined                                                                                            |
| Auditd     | Behavioral Detection | Iodine DNS tunneling                                                                                                                  |
| Auditd     | Behavioral Detection | iperf multicast activity (iperf)                                                                                                      |
| Auditd     | Behavioral Detection | Ipsec tunnel creation                                                                                                                 |
| Auditd     | Behavioral Detection | isnprober technique                                                                                                                   |
| Auditd     | Behavioral Detection | jerry Vmware fingerprinter                                                                                                            |
| Auditd     | Persistence          | Kernel module loaded - Insmod / modprobe activity                                                                                     |
| Auditd     | Behavioral Detection | kismet                                                                                                                                |
| Auditd     | Behavioral Detection | kmod                                                                                                                                  |
| Auditd     | Behavioral Detection | lft                                                                                                                                   |
| Auditd     | Behavioral Detection | LinEnum                                                                                                                               |
| Auditd     | Behavioral Detection | linpmem memory dump                                                                                                                   |
| Auditd     | Behavioral Detection | Linux PrivChecker                                                                                                                     |
| Linux      | Behavioral Detection | local default gw configured                                                                                                           |
| Auditd     | Behavioral Detection | Local firewall policy mod - Iptables –AID or command OR changes to iptables-config                                                    |
| Auditd     | Behavioral Detection | Local firewall rule flush - Iptables –F command                                                                                       |
| Auditd     | Behavioral Detection | Local firewall stop - Commands containing string iptables stop                                                                        |
| Linux      | Behavioral Detection | local fw policy mod                                                                                                                   |
| Auditd     | Behavioral Detection | macof                                                                                                                                 |
| Auditd     | Behavioral Detection | Memory dumping - /dev/mem or /dev/kmem command activity                                                                               |
| Auditd     | Behavioral Detection | mknod activity                                                                                                                        |
| Auditd     | Behavioral Detection | mknod activity by bash                                                                                                                |
| Auditd     | Behavioral Detection | nemesis (packet creation)                                                                                                             |
| Auditd     | Behavioral Detection | Net-SNMP - snmp*                                                                                                                      |
| Auditd     | Behavioral Detection | netstumbler                                                                                                                           |
| Auditd     | Behavioral Detection | nmap activity                                                                                                                         |
| Auditd     | Behavioral Detection | nping activity                                                                                                                        |
| Auditd     | Behavioral Detection | nssl - https://sourceforge.net/projects/nssl/                                                                                         |
| Auditd     | Behavioral Detection | ntp-fingerprint http://www.hackingciscoexposed.com/?link=tools                                                                        |
| Auditd     | Behavioral Detection | p0f                                                                                                                                   |
| Auditd     | Behavioral Detection | packit (maybe defunct)                                                                                                                |
| Auditd     | Behavioral Detection | Passive asset detection system -pads                                                                                                  |
| Auditd     | Behavioral Detection | pf (pfctl)                                                                                                                            |
| Auditd     | Behavioral Detection | ping tunnel (ptunnel)                                                                                                                 |
| Auditd     | Behavioral Detection | PortPush technique                                                                                                                    |
| Auditd     | Behavioral Detection | Powershell activity from a Linux instance                                                                                             |
| Auditd     | Behavioral Detection | process with /etc/passwd arguments                                                                                                    |
| Auditd     | Behavioral Detection | python using base64 encoding - python * import base64 *                                                                               |
| Auditd     | Discovery            | redpill Vmware fingerprinter                                                                                                          |
| Auditd     | Behavioral Detection | rm -rf                                                                                                                                |
| Linux      | Behavioral Detection | Root or su activity                                                                                                                   |
| Auditd     | Behavioral Detection | rootshell piped to tcp device                                                                                                         |
| Auditd     | Behavioral Detection | rsynch                                                                                                                                |
| Auditd     | Discovery            | scoopy Vmware fingerprinter                                                                                                           |
| Auditd     | Discovery            | search for writable executables:                                                                                                      |
| Auditd     | Behavioral Detection | SearchSploit                                                                                                                          |
| Auditd     | Execution            | shell commands with no tty session                                                                                                    |
| Auditd     | Execution            | shell run from /tmp directory                                                                                                         |
| Auditd     | Behavioral Detection | sinfp                                                                                                                                 |
| Auditd     | Behavioral Detection | sing                                                                                                                                  |
| Auditd     | Behavioral Detection | sniffit                                                                                                                               |
| Auditd     | Behavioral Detection | snmpd                                                                                                                                 |
| Auditd     | Behavioral Detection | snmpdelta                                                                                                                             |
| Auditd     | Behavioral Detection | snmpdf                                                                                                                                |
| Auditd     | Behavioral Detection | snmpget                                                                                                                               |
| Auditd     | Behavioral Detection | snmpgetnext                                                                                                                           |
| Auditd     | Behavioral Detection | snmpnetstat                                                                                                                           |
| Auditd     | Behavioral Detection | snmpset                                                                                                                               |
| Auditd     | Behavioral Detection | snmpstatus                                                                                                                            |
| Auditd     | Behavioral Detection | snmptable                                                                                                                             |
| Auditd     | Behavioral Detection | snmptranslate                                                                                                                         |
| Auditd     | Behavioral Detection | snmptrapd                                                                                                                             |
| Auditd     | Behavioral Detection | snmpwalk                                                                                                                              |
| Auditd     | Behavioral Detection | strace command                                                                                                                        |
| Auditd     | Behavioral Detection | suid set on file in /tmp - chmod u+s                                                                                                  |
| Auditd     | Behavioral Detection | sysctl command                                                                                                                        |
| Auditd     | Behavioral Detection | tcpdevice activity - /dev/tcp command activity                                                                                        |
| Auditd     | Behavioral Detection | tcpdump activity                                                                                                                      |
| Auditd     | Behavioral Detection | TLs key activity  - *.key                                                                                                             |
| Auditd     | Behavioral Detection | udpcast - file transfer over IP multicast (udp-sender)                                                                                |
| Auditd     | Behavioral Detection | Unix PrivsecCheck                                                                                                                     |
| Auditd     | Behavioral Detection | unprivileged port start config                                                                                                        |
| Auditd     | Behavioral Detection | user2sid                                                                                                                              |
| Auditd     | Behavioral Detection | vim persistence                                                                                                                       |
| Auditd     | Behavioral Detection | Vmdetect Vmware fingerprinter                                                                                                         |
| Auditd     | Behavioral Detection | xprobe2                                                                                                                               |
| Auditd     | Behavioral Detection | yersenia                                                                                                                              |
| named      | Collection           |  named zone transfer failure: "denied AXFR from*" "zone transfer * denied"                                                            |
| named      | Collection           |  named zone transfer: "IN AXFR -"                                                                                                     |
| syslog     | Collection           |  promiscuous mode: device * entered promiscuous mode"                                                                                 |
| syslog     | Defense Evasion      |  process killed: "killed by SIGTERM"                                                                                                  |
| syslog     | Defense Evasion      |  syslog disk full: "file system full|No space left on device"                                                                         |
| syslog     | Defense Evasion      |  syslog exit: "exiting on signal"                                                                                                     |
| syslog     | Defense Evasion      |  syslog restart: "Syslogd restarted"                                                                                                  |
| syslog     | Defense Evasion      | rsyslog message drops "imuxsock begins to drop messages                                                                               |
| Auditd     | Defense Evasion      | System logs cleared - Wipes of last, $HISTFILE or log files in /var/log                                                               |
| syslog     | Execution            |  AppArmor / SELinux exec or mknod operation denied                                                                                    |
| syslog     | Execution            |  command not allowed                                                                                                                  |
| syslog     | Execution            |  kernel error: "I/O error*" Firmware error detected.| ACPI Error                                                                      |
| syslog     | Execution            |  large syslog message: larger than 1025 bytes                                                                                         |
| syslog     | Execution            |  low memory: "Out of Memory:"                                                                                                         |
| syslog     | Execution            |  malicious ping: "Oversized packet received from *"                                                                                   |
| named      | Execution            |  named invalid packet: "dropping * packet from*"                                                                                      |
| named      | Execution            |  named service fail: "exiting (due to fatal error)"                                                                                   |
| syslog     | Execution            |  possible attack on rpc.statd "rpc.statd[*]: gethostbyname error for *"                                                               |
| syslog     | Execution            |  possible exploit of service fail "segfault" or "segfault at *"                                                                       |
| postfix    | Execution            |  postfil RBL lookup fail: "RBL"                                                                                                       |
| postfix    | Execution            |  postfix auth failure: " authentication failed"                                                                                       |
| postfix    | Execution            |  postfix error burst: "^too many "                                                                                                    |
| postfix    | Execution            |  postfix hostname verify failed: "verification"                                                                                       |
| postfix    | Execution            |  postfix illegal address: "MAIL|does not resolve to address"                                                                          |
| postfix    | Execution            |  postfix send blocked due to IP blacklist: " blocked using "                                                                          |
| postfix    | Execution            |  postfix stop: "^terminating on signal"                                                                                               |
| sshd       | Execution            |  sshd auth failure due to permissions on authorized_keys: "bad ownership or modes for file"                                           |
| sshd       | Execution            |  sshd connection errors: "Connection reset|connection abort"                                                                          |
| sshd       | Execution            |  sshd corrupted MAC input: "Corrupted MAC on input."                                                                                  |
| sshd       | Execution            |  sshd dns error: "but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!$"                                            |
| sshd       | Execution            |  sshd excessive auth attempts: "^error: maximum authentication attempts exceeded "                                                    |
| sshd       | Execution            |  sshd hostkey error: "no hostkey alg [preauth]"                                                                                       |
| sshd       | Execution            |  sshd insecure connection: "Did not receive identification string from"                                                               |
| sshd       | Execution            |  sshd negotiation error: "no matching cipher found"                                                                                   |
| sshd       | Execution            |  sshd negotiation error: "no matching mac found"                                                                                      |
| sshd       | Execution            |  sshd negotiation fail: "Unable to negotiate with |Unable to negotiate a key|fatal: no matching"                                      |
| sshd       | Execution            |  sshd possible exploit: "fatal: buffer_get_string: bad string"                                                                        |
| sshd       | Execution            |  sshd reverse lookup error "failed - POSSIBLE BREAK"                                                                                  |
| sshd       | Execution            |  sshd session error: "Failed to create session: "                                                                                     |
| sshd       | Execution            |  sshd subsystem error: " failed, subsystem not found$"                                                                                |
| sshd       | Execution            |  sshd suspicious packet; "^Bad packet length"                                                                                         |
| sshd       | Execution            |  suspicious ssh conection "Bad protocol version identification"                                                                       |
| syslog     | Execution            | from pid * due to rate-limiting"                                                                                                      |
| syslog     | Execution            | syslog errors "core_dumped|failure|error|attack| bad |illegal |denied|refused|unauthorized|fatal|failed|Segmentation Fault|Corrupted" |
| sendmail   | Initial Access       |  sendmail reject due to ACL "reject=550 5.0.0 |reject=553 5.3.0"                                                                      |
| sendmail   | Initial Access       |  sendmail relay request denied "reject=550 5.7.1"                                                                                     |
| sendmail   | Initial Access       |  sendmail: send fail due to missing domain "reject=553 5.5.4 "                                                                        |
| sendmail   | Initial Access       |  sendmail: sender domain lacks valid MX record "reject=451 4.1.8"                                                                     |
| named      | Initial Access       |  zone transfer error: "bad zone transfer request:"                                                                                    |
| Linux      | Initial Access       | Anomalous  authentication                                                                                                             |
| Linux      | Initial Access       | anomalous /etc/passwd activity                                                                                                        |
| Linux      | Initial Access       | Anomalous root authentication                                                                                                         |
| Linux      | Initial Access       | first su or sudo by a user                                                                                                            |
| Linux      | Initial Access       | large number of DNSSEC requests from one source                                                                                       |
| Auditd     | Initial Access       | zone transfer denied                                                                                                                  |
| Auditd     | Initial Access       | zone transfer succeeded                                                                                                               |
| syslog     | Persistence          |  crontab edit: "BEGIN EDIT"                                                                                                           |
| syslog     | Persistence          |  crontab replace: "REPLACE"                                                                                                           |
| syslog     | Persistence          |  new USB device (in kernel log)                                                                                                       |
| syslog     | Persistence          |  root crontab change: "^(root)"                                                                                                       |
| Auditd     | Persistence          | process started from /tmp (not jenkins)                                                                                               |
| Auditd     | Persistence          | SSH config change - changes to ssh_config file                                                                                        |
| Auditd     | Privilege Escalation | local group mod - Changes to /etc/shadow OR /etc/passwd OR passwd command                                                             |
| Auditd     | Privilege Escalation | Local group mod - Groupadd, groupmod or groupdel (from shell history)                                                                 |
| Auditd     | Privilege Escalation | Local key activity - changes to authorized_keys                                                                                       |
| Auditd     | Privilege Escalation | local root / administrator activity                                                                                                   |
| Auditd     | Privilege Escalation | local user creation - useradd                                                                                                         |
| Auditd     | Privilege Escalation | local user mod                                                                                                                        |
| syslog     | Privilege Escalation | sudo activity                                                                                                                         |
| Auditd     | Privilege Escalation | user / group change, remote caller                                                                                                    |
| Auditd     | Privilege Escalation | user NOT in sudoers                                                                                                                   |
| Auditd     | Behavioral Detection | Shell activity by service account                                                                                                     |
